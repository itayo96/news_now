@{
    ViewBag.Title = "Articles' Location";
}

<h2>@ViewBag.Title</h2>
<input type="button" id="btnShowLocations" value="Show All Locations" />

<div id="myMap" style="position:relative; width:600px; height:600px;"></div>

@*<script src="~/Scripts/jquery-1.10.2.min.js"></script>*@
@section Scripts
{
<script type="text/javascript">
    var map = null;

    function LoadMap() {
        map = new Microsoft.Maps.Map('#myMap', {
            credentials: "AglcOvofpKm1X-WOXDY3_Cr0bxdAbKzUid-4bp7Em3BxbNPK_kT-X8iWI4B1RF0H"
        });
    }

    $('#btnShowLocations').click(function () {
        var url = "/ArticlesLocation/GetLocations";
        $.getJSON(url, null, function (data) {
            var pins = [];

            $.each(data, function (index, Coordinate) {
                var pushpin = new Microsoft.Maps.Pushpin(new Microsoft.Maps.Location(Coordinate.x, Coordinate.y));
                pins.push(pushpin);
            });

            map.entities.push(pins);

            map.setView({
                zoom: 4, center: new Microsoft.Maps.Location(23.505353, 78.485292)
            });
        });
    });
</script>
<script type="text/javascript" src="https://www.bing.com/api/maps/mapcontrol?callback=LoadMap" async defer></script>
}
